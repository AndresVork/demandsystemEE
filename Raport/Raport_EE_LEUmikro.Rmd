---
title: "Tarbimise hinna- ja sissetulekuelastsused AIDS mudeli abil"
author: "TÃœ"
# author: "Andres VÃµrk, Taavi Unt, TÃœ CITIS"
date: "Tehniline raport `r format(Sys.time(), '%d.%m.%Y')`"
output:
  html_document:
    code_folding: hide
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
editor_options:
  chunk_output_type: console
bibliography: Demandsystems.bib
---

<style type="text/css">

body{ /* Normal  */
      font-size: 14px;
  }
td {  /* Table  */
  font-size: 12px;
}
h1.title {
  font-size: 24px;
  color: DarkRed;
}
h1 { /* Header 1 */
  font-size: 20px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 18px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 16px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
library(tidyverse)
library(plotly)

# setwd("C:/Users/avork/Documents/demandsystemEE")
 
```

## Sissejuhatus

KÃ¤esolev analÃ¼Ã¼s hindab Eesti majapidamiste tarbimise hinna- ja kogukulutuste elastused. AnalÃ¼Ã¼s on sisendiks projekti "Projekti C-19 majandus ehk COVID-19 seotud majandusmÃµjude ning nende pehmendamiseks mÃµeldud poliitikameetmete tÃµhususe hindamine" raames (https://c19majandus.ut.ee/) loodud simulatsioonimudelile. AnalÃ¼Ã¼sis kasutatakse leibkonna-eelarve uuringu andmeid kulutuste struktuuri kohta ja tarbijahinnaindeksi komponente kaubagruppide hindade kohta. Elastsuste leidmiseks kasutatakse AIDS nÃµudlussÃ¼steemi  (_almost ideal demand system_) hindamisel saadud parameetreid. AnalÃ¼Ã¼s annab esmalt lÃ¼hiÃ¼levaate nÃµudluse modelleerimise mikroÃ¶konoomilistest alustest. SeejÃ¤rel kirjeldatakse kasutatavaid andmeid,  analÃ¼Ã¼simeetodeid ja tulemusi ning vÃµrreldakse neid teiste uuringute tulemusena. KÃ¤esoleva analÃ¼Ã¼si tulemusena ja tuginetakse varasematele uuringutele pakutakse vÃ¤lja sissetuleku-  ja hinnaelastsused, mida kasutada sisend-vÃ¤ljundtabeli pÃµhises Eesti mudeli. 

<!-- AndmeanalÃ¼Ã¼si aluseks olevad Ri koodid on kÃ¤ttesaadavad githubis https://github.com/AndresVork/demandsystemEE. -->

## LÃ¼hike nÃµudluse modelleerimise mikroÃ¶konoomiline taust

NÃµudluse kvantitatiivse analÃ¼Ã¼si viis ja meetod sÃµltub sellest, mis tasemel analÃ¼Ã¼sitakse (toode, kaubagrupp, majandusharu vÃµi kogumajandus). Enamasti uuritakse hinna, leibkondade sissetuleku ja muude sotsiaaldemograafilsite tegurite mÃµju tarbimisele. Tulemusi vÃ¤ljendatakse numbriliselt sagedasti elastsustena.

![Tabel 1. NÃµudluse modelleerimise tasemed](tabelsissejuhatusjpg.jpg){width=500px}

Empiirilise uuringute puhul on vÃ¤ljakutseks leida kooskÃµla mikroÃ¶konoomika teooria eeldustega tarbijakÃ¤itumise kohta (nn majapidamisteooria), mis seab nÃµudlusfunktsioonidele teatud piirangud.  

Majapidamisteooria jÃ¤rgi vÃµib lihtsustatult vaadata tarbimisotsuste tegemist kahesammulisena. Esimeses sammus otsustatakse kui palju tÃ¶Ã¶tada ja tarbida ning teise sammuna, kuidas tarbimiskulutusi jagada.

1.samm: tarbimiskulude suuruse mÃ¤Ã¤ramine

  - Tarbija maksimeerib heaolu  $ğ‘ˆ=ğ‘ˆ(ğ¿,ğ¶)$
  - Arvestades ajapiirangut     $ğ¿_0=ğ¿+â„$
  - Ja eelarvepiirangut         $ğ‘ğ¶=ğ‘¤â„+ğ‘…$
  - Leiame optimaalse tÃ¶Ã¶tunnid $â„=ğ¹(ğ‘¤,ğ‘,ğ‘…)$ 
  ja tarbimiskulutused $â„=ğ¹(ğ‘¤,ğ‘,ğ‘…)$

Eelarvepiirang vÃµib olla ka mittelineaarne tÃ¶Ã¶tundide suhtes (nt mittelineaarse maksusÃ¼steemi vÃµi toetuste korral). DÃ¼naamilistes mudelites lisandub ka sÃ¤Ã¤stmine, millega silutakse tarbimist.

Kui tarbimise kogukulud teada, siis teise sammuna mÃ¤Ã¤ratakse tarbimise struktuur: 

  - Tarbija maksimeerib heaolu sÃµltuvana erinevate kaupade tarbimisest $ğ‘ˆ=ğ‘ˆ(ğ‘_1,ğ‘_2,...,ğ‘_ğ‘˜)$
  
  - Arvestades eelarvepiirangut $ğ‘_1 ğ‘_1Ã—ğ‘_2 ğ‘_2Ã—...ğ‘_ğ‘˜ ğ‘_ğ‘˜=ğ‘¦$, kus _y_ on kogutarbimine vÃµi kogu sissetulek sÃµltuvana sellest, kas arvestame ka sÃ¤Ã¤stmist vÃµi mitte.
      
MaksimeerimisÃ¼lesande lahendamisel saame nÃµudlusfunktsioonid, kus tarbitav kogus sÃµltub hindadest ja sissetulekust.
  
$$
\begin{aligned}
ğ‘_1=ğ‘“_1 (ğ‘_1,ğ‘_2...ğ‘_ğ‘˜,ğ‘¦)  \\
ğ‘_2=ğ‘“_2 (ğ‘_1,ğ‘_2...ğ‘_ğ‘˜,ğ‘¦)  \\ 
...                               \\
ğ‘_ğ‘˜=ğ‘“_ğ‘˜ (ğ‘_1,ğ‘_2...ğ‘_ğ‘˜,ğ‘¦)
\end{aligned}
$$

Sageli defineeritakse i-nda kauba kulutuste osakaal kogukulutustes $ğ‘¤_ğ‘–=ğ‘_ğ‘–q_ğ‘–/ğ‘¦$ ja seejÃ¤rel vÃµib hinnata seosed kas koguse, kulutuste vÃµi osakaaluna:

$$
\begin{aligned}
\text{kogus   } & ğ‘_ğ‘–=ğ‘“_ğ‘– (ğ‘_1,ğ‘_2...ğ‘_ğ‘˜,ğ‘¦)+ğ‘¢_ğ‘– \\
\text{kulutus   } & ğ‘_ğ‘– ğ‘_ğ‘–=ğ‘“_ğ‘– (ğ‘_1,ğ‘_2...ğ‘_ğ‘˜,ğ‘¦)+ğ‘¢_ğ‘– \\
\text{osakaal   } &ğ‘¤_ğ‘–=ğ‘“_ğ‘– (ğ‘_1,ğ‘_2...ğ‘_ğ‘˜,ğ‘¦)+ğ‘¢_ğ‘–
\end{aligned}
$$

Praktikas kulutusi agregeeritakse erinevatesse gruppidesse. SÃµltuvalt analÃ¼Ã¼si eesmÃ¤rgist eristatakse kestuskaupa ostmist (nt autod, kallim kodutehnika) ja muid kaubagruppe.

MikroÃ¶konoomika majapidamisteooria eelduste kohaselt on omavahel seotud kasulikkuse maksimeerimine vÃµi kulude minimeerimine, Hicksi nÃµudlusfunktsioonid ja Marshalli nÃµudlusfunktsioonid, kulufunktsioon ja kaudne kasulikkusfunktsioon. Sellest tulenevalt saab pÃ¼stitada ja hinnata nÃµudluse vÃµrrandeid ning tervikuid nÃµudlussÃ¼steeme erineval kujul ning tuletada vajalikud seosed hinnatud parameetritest.


### MÃµjuhinnangud ja elastsused

AnalÃ¼Ã¼tikutena ollakse huvitatud nii nÃµudluse absoluutsetest muutustest hindade ja sissetuleku muutudes kui ka suhtelistest muutustest ehk elastsustest. Mikroandmete pÃµhjal hinnatud seosekordajaid ja elastsusi saab omakorda kasutada makromudelites.

  - Oma hinna muutuse mÃµju: $ğœ•ğ‘_ğ‘–/ğœ•ğ‘_ğ‘–$
  - Teise kauba hinna muutuse mÃµju: $ğœ•ğ‘_ğ‘–/ğœ•ğ‘_ğ‘—$
  - Sissetuleku (vÃµi kogukulutuste) muutuse  mÃµju: $ğœ•ğ‘_ğ‘–/ğœ•ğ‘¦$
  - Omahinnaelastus: 

  $$ğ‘’_{ii}=(ğœ•ğ‘_ğ‘–/ğ‘_ğ‘–)/(ğœ•ğ‘_ğ‘–/ğ‘_ğ‘–)=ğœ•lnğ‘_ğ‘–/ğœ•lnğ‘_ğ‘–$$
  
  - Hinna ristelastus: 
  
  $$ğ‘’_{ij}=(ğœ•ğ‘_ğ‘–/ğ‘_ğ‘–)/(ğœ•ğ‘_j/ğ‘_j)=ğœ•lnğ‘_ğ‘–/ğœ•lnğ‘_j$$
    
  - Sissetulekuelastsus vÃµi kogukulutuste elastsus:
  
  $$ğ‘’_{i}=(ğœ•ğ‘_ğ‘–/ğ‘_ğ‘–)/(ğœ•y/y)=ğœ•lnğ‘_ğ‘–/ğœ•lny$$
  

### NÃµudlusfunktsioonid

NÃµudlusfunktsioonide puhul eristatakse Hicksi ja Marshalli nÃµudlusfunktsioone. *Hicksi nÃµudlus* (ehk kompenseeritud nÃµudlus) nÃ¤itab, kuidas muutub nÃµutav kaubakogus, kui muutub hind, teiste hindade ja kasulikkusetaseme samaks jÃ¤Ã¤des: 

$â„_ğ‘–=â„(ğ‘_1,ğ‘_2,...,ğ‘_ğ‘˜,ğ‘ˆ^âˆ—)$

Selleks, et nÃµudlus saaks muutuda, peavad siis muutuma kulutused (sissetulekute vÃ¤henemine kompenseeritakse).


*Marshalli nÃµudlus* (ehk kompenseerimata nÃµudlus) nÃ¤itab, kuidas muutub nÃµutav kaubakogus, kui muutub hind, teiste hindade ja kogukulutuste samaks jÃ¤Ã¤des:

$ğ‘_ğ‘–=ğ‘(ğ‘_1,ğ‘_2,...,ğ‘_ğ‘˜,ğ‘¦)$

NÃµudlus muutudes peab seega muutuma kasulikkus. Makromudelites kasutatakse enamasti kompenseerimata nÃµudlust.


*Slutsky vÃµrrand* seob omavahel Hicksi ja Marshalli nÃµudlused.

$$ğœ•ğ‘_ğ‘–/ğœ•ğ‘_ğ‘—=ğœ•â„_ğ‘–/ğœ•ğ‘_ğ‘—âˆ’ğœ•ğ‘_ğ‘–/ğœ•ğ‘¦Ã—ğ‘_ğ‘—$$
Slutsky vÃµrrand nÃ¤itab, et koguse muutus tulenevalt hinna muutusest (Marshalli nÃµudlus) sÃµltub asendusefektist ja sissetulekuefektist. Asendusefekt nÃ¤itab, mis juhtub kogusega, kui muutuvad suhtelised hinnad, aga kasulikkus jÃ¤Ã¤b samaks. Sissetulekuefekt nÃ¤itab, kuidas muutub kogus, kui muutub sissetulek.

Elastsuste kujul Slutsky vÃµrrand: 

$ğ‘’_{ğ‘–ğ‘—}=ğ‘’_{ğ‘–ğ‘—}^âˆ— âˆ’ğ‘’_ğ‘–Ã—ğ‘¤_ğ‘—$

Marshalli elastsus = Hicksi elastsus - sissetulekuelastsus korda kaubagrupi osakaal tarbimiskuludes.

Slutsky vÃµrrandid kasutatakse selleks, et leida vajadusel puuduv elastsuse nÃ¤itaja.

### ÃœhevÃµrrandilised Ã¶konomeetrilised mudelid

ÃœhevÃµrrandilised Ã¶konomeetrilised mudelid on sobivad kitsama tootegrupi ostude analÃ¼Ã¼simiseks, nt alkoholitoodete tarbimise sÃµltuvus sissetulekutest ja hindadest. ÃœhevÃµrrandilised mudelite sÃµltuv tunnus vÃµib olla kas diskreetne tunnus (nt binaarne, loenduv) vÃµi pidev tunnus (kui palju kulutada).

![Tabel. ÃœhevÃµrrandilised mudelid](yhevorrandilisedmudelid.jpg){width=500px}

### Pidevad Ã¼hevÃµrrandilised mudelid

Pidevad Ã¼hevÃµrrandilised mudelid vÃµivad olla kas lineaarsel kujul vÃµi logaritmkujul (enamasti).

Lineaarne mudel:
$$q_i= \alpha + \gamma_i y + \sum_{j=1}^k \beta_{ij}p_j + u_i$$

VÃµi logaritmkujul:

$$log(q_i)= \alpha + e_i log(y) + \sum_{j=1}^k e_{ij}log(p_j) + u_i$$


Reaalsissetuleku arvutamisel leitakse sageli hinnaindeks Ã¼ksikute hindade geomeetrilise keskmisena. Hinnatud seoseparameetrid annavad kohe elastsused reaalse sissetuleku ja hindade suhtes.


$$
\begin{aligned}
log(q_i) & = \alpha + e_i log(y/P) + \sum_{j=1}^k e_{ij}log(p_j) + u_i \\
logP & = \sum_{j=1}^k w_j log(p_j)
\end{aligned}
$$

Ãœks enam-levinud funktsionaalseid kujusid on **Workingi-Leserâ€™i mudel** [@working_statistical_1943; @leser_forms_1963], kus hinnatakse kulutuste osakaalu sÃµltuvust sissetulekust, hindadest ja vÃµimalusel muudest leibkondi iseloomustavatest teguritest (_H_).

$$w_i= \alpha_0 + \alpha_i log(y) + \sum_{j=1}^k \beta_{ij}log(p_j) + \lambda H_i + u_i$$
kus $w_i= q_i p_i / y$

Workingi-Leseri mudeli kuju on omakorda aluseks AIDS mudelile, kus hinnatakse Ã¼laltoodud seosed kÃµikide kaubagruppide jaoks simultaanselt.

Elastsused avalduvad Workingi-Leseri mudelist jÃ¤rgmiselt:

Kompenseerimata (Marshalli) omahinnaelastsus: $ğ‘’_{ii} =âˆ’1+ğ›½_{ii}/ğ‘¤_ğ‘–$

Risthinnaelastus: $ğ‘’_{ij}=ğ›½_{ij}/ğ‘¤_ğ‘–$

Sissetulekuelastsus: $ğ‘’_ğ‘–=1+ğ›¼_ğ‘–/ğ‘¤_ğ‘–$

Kui mudelis on mitte sissetulek $y$ vaid kogukulud $x$, siis vÃµib eraldi hinnata seose, kus kogukulud $x$ sÃµltuvad sissetulekust $y$. Enamasti ongi tarbimismudelis sissetuleku asemel tarbimise kogukulutused. 

Mikroandmete puhul vÃµib hinnata veel ka Working-Leserâ€™i mudel koos tsenseerimisega (Tobit mudel) vÃµi koos selektsiooniga (Heckmani mudel).


<!-- $$ -->
<!-- ğ‘¤_ğ‘–^âˆ—=ğ›¼_0+ğ›¼_ğ‘–  logâ¡( ğ‘¦)+âˆ‘_(ğ‘—=1)^ğ‘˜â–’ã€–ğ›½_ğ‘–ğ‘—  logâ¡( ğ‘_ğ‘—)ã€—+ğœ†ğ»_ğ‘–+ğ‘¢_ğ‘– -->
<!-- ğ‘¤_ğ‘–^âˆ—={â– (ğ‘¤_ğ‘–â€ƒ"kui" â€„ğ‘¤_ğ‘–^âˆ—>0@0â€ƒ"  kui" â€„ğ‘¤_ğ‘–^âˆ—â‰¤0)â”¤â€ƒ"ja"â€ƒğ‘¢_ğ‘–  ~â¡ğ‘ (0,ğœ^2) -->
<!-- $$ -->

<!-- $$ -->
<!-- ğ‘¤_ğ‘–^âˆ—=ğ›¼_0+ğ›¼_ğ‘–  logâ¡( ğ‘¦)+âˆ‘_(ğ‘—=1)^ğ‘˜â–’ã€–ğ›½_ğ‘–ğ‘—  logâ¡( ğ‘_ğ‘—)ã€—+ğœ†ğ»_ğ‘–+ğ‘¢_ğ‘–ğ¼_ğ‘–^âˆ—=ğ›¼_0+ğ›¼_ğ‘–  logâ¡( ğ‘¦)+âˆ‘_(ğ‘—=1)^ğ‘˜â–’ã€–ğ›½_ğ‘–ğ‘—  logâ¡( ğ‘_ğ‘—)ã€—+ğœ†ã€–ğ»^â€²ã€—_ğ‘–+ğ‘£_ğ‘–ğ‘¤_ğ‘–^âˆ—={â– (ğ‘¤_ğ‘–â€ƒ"kui" â€„ğ¼_ğ‘–^âˆ—>0@"pole jÃ¤lgitav" â€ƒ"  kui" â€„ğ¼_ğ‘–^âˆ—â‰¤0)â”¤â€ƒ"ja"â€ƒ(â– (ğ‘¢_ğ‘–@ğ‘£_ğ‘– ))  ~â¡ğ‘ ğ¼ğ·((â– (0@0)),â€„(â– (ğœ_1^2&ğœ_12@ğœ_12&1))) -->

<!-- $$ -->


### TarbimisevÃµrrandite sÃ¼steemid

Kui tegemist on tarbija eelarve jaoks oluliste kaubagruppidega, siis peab arvestama, et leibkonnad teevad kulutused simultaanselt ja ei saa iga tootegrupi vÃµrrandid kÃ¤sitleda eraldiseisvalt vaid peab hindama nÃµudlusvÃµrrandid korraga.

<!-- - â€MÃµnevÃµrrandilised mudelidâ€œ, Nt kaks kauba vÃµrrandit, mis seotud -->

NÃµudlussÃ¼steemi hidamisel on palju erinevaid lÃ¤henemisi. NÃµudlussÃ¼steemi puhul arvestatakse, et kaubagruppidele tehtud kulutuste kogusumma peab vÃµrduma tarbimiskulude kogusummaga. Teaduskirjanduses on vÃ¤lja pakutud palju erinevaid nÃµudlussÃ¼steeme: 

- The Linear Expenditure System
- The Extended Linear Expenditure Model
- The Rotterdam Model
- The Quadratic Expenditure System
- The Indirect Translog Model
- AIDS - The Almost Ideal Demand System
- Quadratic AIDS (QUAIDS)
- Linear Approximation AIDS (LA-AIDS)
- PADS â€“ Perhaps Adequate Demand System
- Censored Demand Systems
- Dynamic Demand Systems
- ...

Esimene, kes tuletas tarbijateooriast nÃµudlusvÃµrrandite sÃ¼steemi (ehk nÃµudlussÃ¼steemi) ja hindas selle oli Stone (1954). Populaarseks hindamismudeliks kujunenud AIDSi vÃµtsid esimesena kasutusele Deaton ja Muellbauer (1980). NÃµudlussÃ¼steeme on empiiriliselt hinnatud paljude riikide kohta. 

<!-- NÃ¤iteks on hinnatud sÃ¼steemid Ungari, Poola ja TÅ¡ehhi jaoks (Banse ja Brosig, 1998). Mitmeastmelist eelarvestamist on kasutatud ja seega ka Ã¼ksikute toiduainete gruppide jaoks nÃµudluse hinna- ja sissetulekuelastsused on leitud nÃ¤iteks TÅ¡ehhi (Brosig, 1998) ja Sloveenia, Bulgaaria ning Rumeenia puhul (Mergos ja Mizzi, 1999). Elanikkonda sissetulekute jÃ¤rgi kolmeks grupiks jagades on leitud toiduainete nÃµudluselastsused USA jaoks (Huang ja Lin, 2000). -->


## AnalÃ¼Ã¼simetoodika

### Almost Ideal Demand System (AIDS)

Empiirilises analÃ¼Ã¼sis kasutatakse AIDS mudelit. AlljÃ¤rgnevalt antakse lÃ¼hiÃ¼levaade mudeli struktuurist tuginedes palju Henningseni Ã¼levaatele @henningsen_demand_2017.

AIDS nÃµudlussÃ¼steemil [@deaton_almost_1980] on mitmeid hÃ¤id teoreetilisi omadusi: 
a) ta on esimest jÃ¤rku lÃ¤hendus suvalisele nÃµudlussÃ¼steemile,
b) ta rahuldab mikroÃ¶konoomikast tundud eeldusi tarbijakÃ¤itumise kohta,
c) seda on vÃµimalik agregeerida Ã¼le Ã¼ksikute inimeste sÃ¤ilitades siiski mittelineaarse Engeli kÃµvera,
d) homogeensuse omadust (tarbimine ei muutu, kui hinnad ja sissetulekud suurenevad kÃµik vÃµrdselt) ja sÃ¼mmeetria omadusi (ristelastsused on vÃµrdsed) saab testida
e) nÃµudlussÃ¼steem muutub lineaarseks, kui translog kujul olevat hinnaindeksid lÃ¤hendada Stone'i hinnaindeksiga.


<!-- (+) Rahuldab teoreetilisi kitsendusi -->
<!-- (-) Hinnaindeks parameetrite suhtes mittelineaarne - keeruline hinnata ning Engeli kÃµverad mittelineaarsed. Selle tÃµttu vÃµib mÃµni osakaal minna negatiivseks kui sissetulek kasvab. -->

AIDS mudel tugineb mikroÃ¶konoomikast tuntud majapidamisteooriale. Mudeli alguskohaks on kulutuste funktsioon (mis nÃ¤itab, milline on minimaalne kulutus $m$, mida majapidamine peab tegema, et saavutada etteantud hindade $p$ korral vajalik kasulikkuse tase $U$).

$$\ln m_t = \ln e(p_t, U_t) = \alpha_0 + \sum_{i} \alpha_{i} \ln p_{it} + \frac{1}{2}\sum_{i}\sum_{ij} \gamma^*_{ij}\ln p_{it} \ln p_{jt} + U_t\beta_0\prod_i p^{\beta_i}_{it}$$
Kulutuste funktsioonist saab tuletada Shepardi lemma abil Marshalli nÃµudlusfunktsioonid asendades kasulikkusfunktsiooni kaudse kasulikkusfunktsiooniga.

$$x_{it}(p_t, m_t) = \frac{m_t}{p_{it}} (\alpha_i + \sum_{j} \gamma_{ij} \ln p_{jt} + \beta_i \ln(m_t/P_t))$$
kus $x_{it}$ on tarbitav kogus ja parameetrid $\gamma_{ij}$ on seotud esialgsete parameetritega $\gamma_{ij} = \frac{1}{2} (\gamma^*_{ij} + \gamma^*_{ji})$.

$P_t$ on translog hinnaindeks, mis teeb mudeli algselt mittelineaarseks.

$$\ln P_t= \alpha_0 + \sum_{i} \alpha_{i} \ln p_{it} + \frac{1}{2} \sum_{i}\sum_{j} \gamma_{ij} \ln p_{it} \ln p_{jt}$$
Marshalli nÃµudlusfunktsioone saab lihtsustada avaldades koguste asemel osakaalud.

$$s_{it}(p_t, m_t) = \frac{x_{it}p_{it}}{m_t}  = \alpha_i + \sum_{j} \gamma_{ij} \ln p_{jt} + \beta_i \ln(m_t/P_t)$$

MikroÃ¶konoomika teooriast tulenevad kitsendused nÃµudlussÃ¼steemile.
1) Osakaalude summa peab vÃµrduma Ã¼hega. See on alati tÃ¤idetud, kui parameetritele kehtivad jÃ¤rgmised kitsendused:

$$\sum_i\alpha_i =1; \space \sum_i\beta_i =0; \space \sum_{i} \gamma_{ij} =0 \space \forall \space j$$

2) ei tohi olla raha illusiooni (homogeensuse tingimus) - kui kÃµik hinnad ja sissetulekud suurenevad sama arv korda, siis nÃµudlus ei muutu.

$$\sum_{j} \gamma_{ij} =0 \space \forall \space i$$

3) SÃ¼mmeetria tingimus tuleb Shepardi lemmast. 

$$\gamma_{ij} = \gamma_{ji} \space \forall \space i, j$$

Empiiriliselt hindamegi seosed osakaalude kujul:

$$w_{it}= \alpha_i + \sum_{j} \gamma_{ij} \ln p_{jt} +  \beta_i \ln(m_t/P_t) + u_{it} $$

Parameetride hindamisel peab Ã¼he vÃµrrandi vÃ¤lja jÃ¤tma, sest kuna vealiikmete summa on automaatselt null $\sum_i u_{it} =0 \space \forall \space t$, siis on vealiikmete kovariatsioonimaatriks singulaarne. Ãœhe vÃµrrandi puuduvad parameetrite hinnangud tuletatakse siis Ã¼laltoodud piirangutest parameetritele.

Marshalli nÃµudlusfunktsioonid ise on kÃ¼ll lineaarsed, kuid kuna hinnaindeks on mittelineaarne, siis on mudeli hindamine siiski keerukas. Peale mudeli parameetrite hindamist saab leida hinnangud elastsustele, kuid need on nÃ¼Ã¼d keerulisemate valemitega, sest hinna mÃµju avaldub lisaks lÃ¤bi Ã¼ldise hinnaindeksi.

<!-- Sissetulekuelastsus avaldub jÃ¤rgmiselt (sama, mis Ã¼lal Working-Leseri mudelis) -->

<!-- $$\varepsilon_i = 1+\beta_i / w_i $$ -->

<!-- Otsese Marshalli hinnaelastsuse lÃ¤hendina saab kasutada jÃ¤rgmisi valemeid -->

<!-- $$\varepsilon_{ii}=(\gamma_{ii}-\beta_i \times w_i)/ğ‘¤_i - 1$$ -->

<!-- ja risthinnaelastsus -->

<!-- $$\varepsilon_{ij}=(\gamma_{ij}-\beta_i \times w_j)/ğ‘¤_i$$ -->


<!-- Elastused vÃµib leida, kas keskmiste osakaalude juures vÃµi leida kÃµikide vaatluste jaoks ning siis leida keskmine Ã¼le elastsuste. -->


### Linear Approximate Almost Ideal Demand System 

Et translog hinnaindeksiga nÃµudlussÃ¼steemi on keeruline hinnata, sest tegemist on vÃ¤ga mittelineaarse sÃ¼steemiga, siis kasutatakse sageli hinnaindeksi puhul lineaarset lÃ¤hendit.

LA-AIDS = AIDS koos lineaarse hinnaindeksiga

$$w_{it}= \alpha_i^S + \sum_{j} \gamma^S_{ij} \ln p_{jt} +  \beta^S_i \ln(m_t/P^S) + u^S_{it} $$

kus $P^S$ on Stoneâ€™i hinnaindeks

$$lnP^S_t = \sum_{i} w_{it} \ln p_{it}$$ 

Et Stone'i hinnaindeks kasutab osakaale, siis on nii vÃµrrandi paremal kui vasakul pool samad tunnused. Stone'i hinnaindeksi asemel vÃµib kasutada ka teisi hinnaindekseid, nt Laspeyrese hinnaindeks, mis kasutab sama perioodi osakaalude asemel keskmisi osakaale, et vÃ¤hendada vÃµrrandite simultaansust.

$$lnP^L = \sum_i \bar w_{i} \ln p_i$$ 

VÃµib kasutada ka viitajaga kaaludega Stone'i hinnaindeksit:

$$lnP^{SL}_t = \sum_{i} w_{i, t-1} \log p_{it}$$ 

Esineb ka teisi lÃ¤hendusi hinnaindeksitele. 


Kui mudeli parameetrid on hinnatud kas vÃ¤himruutude meetodil, Ã¼ldistaud vÃ¤himruutude meetodil (SURE - seemingly unrelated regression equations) vÃµi iteratiivselt, siis saab hinnatud parameetritest avaldada elastsused. 

Otsese Marshalli hinnaelastsuse lÃ¤hendina saab kasutada erinevaid valemeid. Nt Chalfant (1987) pakub jÃ¤rgmist lÃ¤hendit:

$$\varepsilon_{ii}=(\gamma_{ii}-\beta_i \times w_i)/ğ‘¤_i - 1$$

ja risthinnaelastsuse lÃ¤hendina:

$$\varepsilon_{ij}=(\gamma_{ij}-\beta_i \times w_j)/ğ‘¤_i$$

Esineb veel teisi vÃµimalusi. 
<!-- (AIDS, Green + Alston, Goddard, Eales + Unnevehr). -->

Elastused vÃµib leida, kas keskmiste osakaalude juures vÃµi leida kÃµikide vaatluste jaoks ning siis leida keskmine Ã¼le elastsuste.

<!-- _TODO:! TÃ¤psustada elastsuste erinevad valemid_ -->

KÃ¤esolevas analÃ¼Ã¼sis esitatakse tulemused nii AIDS kui LA-AIDS mudelist kasutades kas Stone hinnaindeksit ja lihtsustatud Laspeyrese hinnaindeksit. Elastsuste valemina kasutatakse vaikimisi pakutud lÃ¤hendit Ri paketis `micEconAids`. 


## Andmed

AnalÃ¼Ã¼sis kasutame kulutuste struktuuri Eesti leibkonna eelarve uuringu (LEU) andmetest ning hindade infot Eurostati tarbijahindade harmoniseeritud indeksi (HICP) komponentidest. AnalÃ¼Ã¼sis kasutatakse LEU mikroandmete pÃµhjal leitud kvartaalset kulutuste struktuuri koos ja tarbimiskvintiilide kaupa aastatel 2000-2007, 2010-2012, 2015-2016 ja 2019-2020. Tarbimiskvintiilide lÃµikes analÃ¼Ã¼si vÃµimaldab paremini hinnata nÃµudluse elastsused tarbimiskulude kohta, kuid ei anna kahjuks lisainformatsiooni hindade varieeruvuse kohta, sest hinnad vÃµetakse kÃµigile etteantud ajaperioodil Ã¼hesugused. 

Hinnad on vÃµetud Eurostatist HICP kuistest andmetest tabelist HICP (2015 = 100) - monthly data (index)[prc_hicp_midx] (https://appsso.eurostat.ec.europa.eu/nui/show.do?dataset=prc_hicp_midx&lang=en) ja teisendatud kvartaalseteks. Leibkonna eelarve uuringu andmeid on tÃ¶Ã¶deldud Statistikaameti turvalisel tÃ¶Ã¶kohal.

LEU mikroandmete pÃµhjal agregeeritakse leibkondade rahaline tarbimine kokku jÃ¤rgmistesse gruppidesse COICOPi esimesel tasemel ning seotakse sobiva hinnaindeksiga.

**Tabel. AnalÃ¼Ã¼sitavad kaubagrupid**

LEU 2010-2020| Hinnaindeks| 
|:-------------|:--------------|
| Kulutused kokku| | 
| Tarbimiskulud| CP00 Kokku| 
| Toit ja alkoholita joogid| CP01 Toit ja mittealkohoolsed joogid| 
| Alkoholjoogid ja tubakas| CP02 Alkohoolsed joogid ja tubakatooted| 
| RÃµivad ja jalatsid| CP03 Riietus ja jalatsid| 
| Eluase| CP04 Eluase| 
| Majapidamiskulud| CP05 Majapidamine| 
| Tervishoid| CP06 Tervishoid| 
| Transport| CP07 Transport| 
| Side| CP08 Side| 
| Vaba aeg| CP09 Vaba aeg| 
| Haridus| CP10 Haridus ja lasteasutused| 
| Restoranid ja hotellid| CP11 SÃ¶Ã¶mine vÃ¤ljaspool kodu, majutus| 
| Mitmesugused kaubad ja teenused| CP12 Mitmesugused kaubad ja teenused| 


Tarbimiskulud kvintiilide lÃµikes on toodud jÃ¤rgmisel joonisel.

![Joonis. Tarbimiskulutused kvintiilide lÃµikes](../joonised/LEUkvartaalsedsummadmikro.PNG){width=800px}

Tarbimiskulude osakaalud kogu tarbimiskuludest tarbimiskvintiilide lÃµikes on toodud jÃ¤rgmisel joonisel.

![Joonis. Tarbimiskulutuste struktuur kvintiilide lÃµikes](../joonised/LEUkvartaalsedosakaaludmikro.PNG){width=800px}

Kasutatavate hinnaindeksite kvartaalne dÃ¼naamika on esitatud jÃ¤rgmisel joonisel.

![Joonis. Hinnaindeksid](../joonised/kvartaalsedhinnaindeksid2.PNG){width=500px}

Esitletud hindade erinevat dÃ¼naamikat kasutatakse hinnaelastsuste leidmiseks.

Et erinevate tarbimisrÃ¼hmade jaoks on tarbimise osakaalud erinevaid, siis on ka elukalliduse muutus erinev. JÃ¤rgmisel joonisel on esitatud tinglikult kvintiilide elukalliduse muutus (nn Stone'i hinnaindeks).

![Joonis. Hinnaindeksid](../joonised/kvartaalnestoneihinnaindks.PNG){width=500px}


## EelanalÃ¼Ã¼s

Enne komplitseeritud AIDS mudeli hindamist iseloomustame tarbimise seost sissetulekuga. AlljÃ¤rgneval joonisel on esitatud Working-Leseri tÃ¼Ã¼pi seosed, kus kulutuste osakaal kaubagrupile sÃµltub logaritmitud reaalsest kogukulutusest kvartalite ja tarbimiskvintiilide lÃµikes. Joonisele on lisatud ka silutud seosed kvintiilide kaupa ja lineaarne regressiooniseos, kui hinnata seos eraldi vaid sÃµltuvana reaalsest sissetulekust.

Andmetest on selgelt nÃ¤ha, et vÃ¤ga tugev seos sissetuleku ja tarbimiskulutuste osakaalu vahel esineb toidukaupade (determinatsioonikordaja $R^2=0.93$), majapidamiskulude ($R^2=0.73$), transpordikulude ($R^2=0.80$) ja vaba ajaga seotud kulutuste puhul ($R^2=0.76$). ÃœlejÃ¤Ã¤nud tarbimisgruppide puhul on seosed nÃµrgemad (nt tervishoid) vÃµi kÃ¤ituvad ka tarbimiskvintiilide lÃµikes lausa erinevalt (nt sidekulud vÃµi haridus).

![Joonis. Hinnaindeksid kvintiilide jaoks](../joonised/osakaaljasissetulekkvintiilideloikes2.PNG){width=800px}

Osade kaubagruppide puhul on nÃ¤ha, et ehkki keskmiselt valitseb positiivne seos kogu tarbimiskulude ja osakaalu vahel (nt grupid "Muud kaubad ja teenused" vÃµi "Riided ja jalatsid"), siis iga tarbimisgrupi sees on kogu tarbimiskulutuste kasvades osakaal vÃ¤henenud. Taolist vÃµimalikku dÃ¼naamikat vÃµib selgitada, kas hindade dÃ¼naamikaga vÃµi kvintiilide erineva sotsiaaldemograafilise struktuuriga (nt eakad inimesed kuuluvad enamasti kahte alumisse kvintiili).

Ãœlaltoodud seostest saab leida ka kohe sissetulekuelastsused (tÃ¤psemalt antud juhul reaalsete kogukulutuste elastsused), kui eeldada, et Ã¼laltoodud joonistel esitatud lineaarsed sirged on piisavalt head lÃ¤hendid tegelikule seosesle. Elastsused on hinnatud keskmise osakaalu juures.


**Tabel. Kogukulutuste elastsused sissetulekuga vÃµrranditest**

Grupp| Ãœhine mudel|  Fikseeritud efektiga mudel|
|:-------------|:--------------|:--------------|
| Toit ja alkoholita joogid| 0.536| 0.544| 
| Alkoholjoogid ja tubakas| 0.792| 0.775| 
| RÃµivad ja jalatsid| 1.33| 0.645| 
| Eluase| 0.699| 1.04| 
| Majapidamiskulud| 1.58|1.62|  
| Tervishoid|1.15 | 1.61| 
| Transport| 1.86 | 1.62 | 
| Side| 0.614 | 0.819| 
| Vaba aeg| 1.48| 1.65 | 
| Haridus| 1.93| 1.01 | 
| Restoranid ja hotellid| 1.79| 1.40 | 
| Mitmesugused kaubad ja teenused| 1.28 | 0.729|  

Kui hinnata kÃµik kvintiilid koos, siis kogukulutuste suhtes on alaelastsed toidukaubad, alkohoolsed joogid ja tubakas, eluasemekulud ja sidekulud. ÃœlejÃ¤Ã¤nud kaubagruppide elastsused kogukulutuste suhtes on Ã¼leelastsed. KÃµige enam reageerivad sissetuleku muutustele hariduskulud, transpordikulud ning restoranides ja hotellides tehtavad kulutused. Kui lubada pÃ¼sivaid erinevusi kvintiilidele omaette vabaliikme (fikseeritud efekti) nÃ¤ol, nt mis vÃµtaks arvesse erinevat kvintiilide sotsiaaldemograafilist struktuuri, siis vÃ¤heneb elastsus oluliselt kaubagruppidel "RÃµivad ja jalatsid", "Mitmesugused kaubad ja teenused" ja "Haridus". Elastsus suureneb mÃ¤rkimisvÃ¤Ã¤rselt eluasemekulude ja tervishoiu puhul.


## Mudeli hindamistulemused

JÃ¤rgmiselt hinnatakse seosed tarbimiskulutuste osakaalude, kogukulutuste ja hindade vahel kasutades AIDS mudelit. Mudeli hindamiseks kasutame Ri paketis `micEconAids` toodud funktsioone `aidsEst` AIDS mudeli hindamiseks ja `elas` hinna ja kogukulutuste elastuse hindamiseks [@henningsen_demand_2017].

### Sissetulekuelastsused

AlljÃ¤rgnevas tabelis on esitatud sissetulekuelatsused kahe erinevate mudelite pÃµhjal, kus ei ole eristatud kvintiilide andmeid vaid kasutatakse Ã¼ksnes aegridade pÃµhist informatsiooni. Teises veerus on lineaarselt lÃ¤hendatud AIDS mudeli tulemused, kui kasutada Stone'i hinnaindeksit, kolmandas veerus Laspeyrese lihtsustatud hinnaindeksit ja neljandas veerus on mittelineaarse AIDS mudeli tulemused. Viimases kahes veerus on esitatud elastused mudelitest, mis kasutavad kvintiilide andmeid ehk arvestatakse ka kogukulutuste variatsiooniga, mis tuleb erinevustest kvintiilide vahel.


**Tabel. Kogukulutuste elastsused LA/AIDS mudelist**

Grupp| Stone| LaspeyresS | AIDS | Stone_kvint | AIDS_kvint 
|:-------------|:--------------|:-------------|:--------------|:--------------|:--------------|
| Toit ja alkoholita joogid| 0.49 | 0.49| 0.51| 0.46| 0.48| 
| Alkohol ja tubakas| 0.46| 0.47| 0.53| 0.77| 0.77|
| RÃµivad ja jalatsid| 1.68| 1.73| 1.86| 1.45| 1.44|
| Eluase| 0.73| 0.66| 0.62| 0.62| 0.63|
| Majapidamiskulud| 1.06|1.12| 1.25|  1.55| 1.54|
| Tervishoid|1.44 | 1.40| 1.30| 1.08| 1.07|
| Transport| 1.65 | 1.67| 1.64 | 1.82| 1.79|
| Side| 1.01 | 1.03| 1.04| 0.55| 0.57|
| Vaba aeg| 1.36| 1.33| 1.28 | 1.42| 1.42|
| Haridus| 1.36| 1.56| 1.35 | 1.96| 1.94|
| Restoranid ja hotellid| 1.17| 1.07| 0.88 | 1.76| 1.74|
| Mitmesugused kaubad ja teenused| 1.12 | 1.17| 1.27|  1.36| 1.35|

KÃµik tulemused viitavad, et toidukaubad, alkohol ja tubakas on alaelastsed kogukulutuste suhtes. Toidukaupade elatsus on ligikaudu 0.5, alkoholil ja tubakal 0.8, kui kasutada kvintiilidega andmeid. 

Samuti on alaelastsed eluasemekulutused elastsusega ca 0.6-0.7. Kokku moodustavad need kolm kaubagruppi ligikaudu kolmandiku tarbimiskuludest. Teised kaubagrupid on pigem Ã¼leelastsed, konkreetne punkthinnang sÃµltub hindamismeetodist.

Sissetulekuelatsuste punkthinnangute usalduspiiride leidmiseks on erinevaid ligilÃ¤hedasi valemeid. AlljÃ¤rgnevalt on esitatud AIDS meetodiga hinnatud mudeli kogukulutuste elastsuste usalduspiirid kahest erinevast mudelist. Joonisel toodud elastsuste keskmised punktid ei lange tÃ¤pselt kokku eelmises tabelis toodud keskvÃ¤Ã¤rtustega, sest elastsused on hinnatud erinevas punktis.


```{r}
#Andmed kÃ¤sitsi trÃ¼kitud ESA serverist. Et mudeli parameetrid, siis turvariski ei ole.
#Samas peaks ESAle nÃ¤itama neid.

#vt https://stackoverflow.com/questions/35654364/ggplot-jitter-geom-errorbar

eiaidskoond <- data.frame(punkthinnang = c(0.517, 0.54, 1.87, 0.62, 1.24, 1.31, 1.65, 1.04, 1.29, 1.36, 0.88, 1.28),
                     standardvead = c(0.060, 0.298, 0.281, 0.178, 0.248, 0.306, 0.209, 0.238, 0.168, 0.794, 0.332, 0.418), coicop = c("Toit ja alkoholita joogid", "Alkohol ja tubakas", 
"RÃµivad ja jalatsid", "Eluase", "Majapidamiskulud", 
"Tervishoid", "Transport", "Side", "Vaba aeg", "Haridus",
"Restoranid ja hotellid", "Mitmesugused kaubad ja teenused"),
mudel = rep("Kvartaalsed", 12))


eiaidskvint <- data.frame(punkthinnang = 
                            c(0.451, 0.77, 1.41, 0.61, 1.50, 1.08, 1.72, 0.54, 1.40, 1.87, 1.69, 1.34),
                     standardvead = c(0.008, 0.021, 0.022, 0.022, 0.019, 0.026, 0.022, 0.022, 0.014, 0.067, 0.025, 0.014), coicop = c("Toit ja alkoholita joogid", "Alkohol ja tubakas", 
"RÃµivad ja jalatsid", "Eluase", "Majapidamiskulud", 
"Tervishoid", "Transport", "Side", "Vaba aeg", "Haridus",
"Restoranid ja hotellid", "Mitmesugused kaubad ja teenused"),
mudel = rep("Kvartaalsed ja kvintiiliti", 12))

coicopnimed <- c("Toit ja alkoholita joogid", "Alkohol ja tubakas", "RÃµivad, jalatsid", "Eluase", 
"Majapidamiskulud", "Tervishoid", "Transport", "Side", "Vaba aeg", "Haridus", "Restoranid, hotellid", "Muud")

eiaids <- bind_rows(eiaidskoond, eiaidskvint)

eiaids$coicop <- factor(coicopnimed, levels = coicopnimed)

ggplot(eiaids, aes(x=coicop, y = punkthinnang,  color=mudel)) +
  geom_errorbar(aes(x=coicop, ymin=punkthinnang-2*standardvead, 
                    ymax = punkthinnang + 2*standardvead), width=0.2, size=1, position=position_dodge(width=0.5), linetype = "dotted") + 
geom_point(size=2, position=position_dodge(width=0.5)) +
labs(title="Kogukulutuste elastsus", y = "Elastsus", x="", color ="Mudeli andmed")  +
  coord_flip() +
  #geom_hline(yintercept=1)+
    theme_bw()

```

Kui mudelid hinnata andmetes, kus on eraldi tarbimiskulutuste kvintiilid, siis on juures tÃ¤iendav variatsioon kulutuste suuruse koha ja elastsuste usalduspiirid tulevad vÃ¤ga vÃ¤ikesed. Enamasti kvntiilide andmete pÃµhjal leitud punkthinnangud ei muutu oluliselt ja jÃ¤Ã¤vad ka koondandmete pÃµhjal hinnatud mudelist leitud elastsuste usalduspiiride vahemikku. 


### Omahinnaelastsused

Analoogselt sissetulekuelastsustega hinnatakse erinevate andmete ja meetoditega ka oma hinnaelastsused (Marshalli elastsused). Et kÃµikide kvintiilide jaoks on hinnaindeksid samad, siis lisavarieeruvust kvintiilide andmete kasutamisest ei saa, mistÃµttu hinnangute usalduspiirid on laiad mÃµlema andmestiku korral. Hinnatud elastsuste punkthinnangud on toodud alljÃ¤rgnevas tabelis.


**Tabel. Omahinnaelastsused LA/AIDS mudelist**

Grupp| Stone| LaspeyresS | AIDS | Stone_kvint | AIDS_kvint 
|:-------------|:--------------|:-------------|:--------------|:--------------|:--------------|
| Toit ja alkoholita joogid| -0.13 | -0.12| -0.12| -0.26| -0.26| 
| Alkohol ja tubakas| -0.98| -0.98| -0.99| -1.41| -1.41|
| RÃµivad ja jalatsid| -0.40| -0.45| -0.43| -0.63| -0.63|
| Eluase| -0.80| -0.74| -0.78| -0.43| -0.42|
| Majapidamiskulud| -1.47|-1.50| -1.47|  -1.39| -1.40|
| Tervishoid|-0.57 | -0.54| -0.62| 0.02| 0.02|
| Transport| -0.17 |-0.15| -0.15 | -0.33| -0.34|
| Side| -0.39 | -0.45| -0.42| -0.78| -0.77|
| Vaba aeg| -1.73| -1.61| -1.68 | -2.15 | -2.14|
| Haridus| -1.57| -1.55| -1.47 | -1.07| -1.01|
| Restoranid ja hotellid| 1.10| 1.38| 1.19 | -0.14| -0.17|
| Mitmesugused kaubad ja teenused| -3.80 | -3.53| -3.73|  -3.35| -3.32|


Punkthinnangute jÃ¤rgi on kÃµik vÃ¤lja arvatud restoranide ja hotellide teenuste tarbimine negatiivse hinnaelastsusega. Tervishoiuteenuste puhul ja restoranide ning hotellide puhul sÃµltub tulemus sellest, kas kasutada andmeid koos vÃµi kvintiilide kaupa eraldi.

Hinnaelastsuste punkthinnangute usalduspiiride iseloomustamiseks on taas esitatud AIDS meetodiga hinnatud mudelite elastsused.


```{r}
#vt https://stackoverflow.com/questions/35654364/ggplot-jitter-geom-errorbar

eiiaidskoond <- data.frame(punkthinnang = c(-0.14, -0.98, -0.44, -0.74, -1.48, -0.52, -0.14, -0.44, -1.63, -1.56, 1.37, -3.63),
                     standardvead = c(0.195, 0.525, 0.832, 0.326, 1.144, 0.677, 0.453, 0.515, 0.623, 1.359, 0.866, 2.49), coicop = c("Toit ja alkoholita joogid", "Alkohol ja tubakas", 
"RÃµivad ja jalatsid", "Eluase", "Majapidamiskulud", 
"Tervishoid", "Transport", "Side", "Vaba aeg", "Haridus",
"Restoranid ja hotellid", "Mitmesugused kaubad ja teenused"),
mudel = rep("Kvartaalsed", 12))


eiiaidskvint <- data.frame(punkthinnang = 
                            c(-0.323, -1.388, -0.626,-0.441, -1.430, 0.049, -0.247, -0.778, -2.242, -1.009, -0.048, -3.90),
                     standardvead = c(0.195, 0.337, 0.592, 0.237, 0.882, 0.441, 0.375, 0.215, 0.489, 0.988, 0.709, 1.448), coicop = c("Toit ja alkoholita joogid", "Alkohol ja tubakas", 
"RÃµivad ja jalatsid", "Eluase", "Majapidamiskulud", 
"Tervishoid", "Transport", "Side", "Vaba aeg", "Haridus",
"Restoranid ja hotellid", "Mitmesugused kaubad ja teenused"),
mudel = rep("Kvartaalsed ja kvintiiliti", 12))

coicopnimed <- c("Toit ja alkoholita joogid", "Alkohol ja tubakas", "RÃµivad, jalatsid", "Eluase", 
"Majapidamiskulud", "Tervishoid", "Transport", "Side", "Vaba aeg", "Haridus", "Restoranid, hotellid", "Muud")

eiiaids <- bind_rows(eiiaidskoond, eiiaidskvint)

eiiaids$coicop <- factor(coicopnimed, levels = coicopnimed)

ggplot(eiiaids, aes(x=coicop, y = punkthinnang,  color=mudel)) +
  geom_errorbar(aes(x=coicop, ymin=punkthinnang-2*standardvead, 
                    ymax = punkthinnang + 2*standardvead), width=0.2, size=1, position=position_dodge(width=0.5), linetype = "dotted") + 
geom_point(size=2, position=position_dodge(width=0.5)) +
labs(title="Hinnaelastsus", y = "Elastsus", x="", color ="Mudeli andmed")  +
  coord_flip() +
  #geom_hline(yintercept=1)+
  theme_bw() +
  theme(legend.position = "bottom")

```


## VÃµrdlus teiste uuringutega ning vÃµimalik kasutamine sisend-vÃ¤ljund mudelis

Varasemalt on Eesti andmete pÃµhjal AIDS meetodiga Ã¼ritanud tarbimise hinna- ja kogukulutuste elastsust hinnata @vork_eesti_2002, kes kasutasid kvartaalseid andmeid 1996-2001 12 kaubagrupi kohta kulukvintiilide lÃµikes. Nad raporteerivad, et toidu- ja mittealkohoolsete jookide kogukulutuste elastsusteks leidsid  0.3-0.4 ja otseseks hinnaelastsuseks ca -0.5. KÃ¤esolevas analÃ¼Ã¼sis saime kogukulutuste elastsuseks 0.5 ja hinnaelastuseks -0.1 kuni -0.3, mis on vÃµrdlemisi lÃ¤hedane tulemus.

<!-- TODO:! Lisada juurde teisi Eesti uuringuid, kui neid leidub. -->

Euroopa Komisjoni JRC koostatud pikaajaline majandussektoreid hÃµlmav mudel FIDELIO [@kratena_fidelio_2017] kasutab samuti hinna- ja kogukulutuste elastsusi. Eraldi kÃ¤sitletakse kestuskaupasid ja energiakaupasid.
Mittekestus ja -energiakaupade hinna- ja kogukulutuste elastsused on jÃ¤rgmised.

![FIDELIO mudelis kasutatud elastused](fidelioelastsused.png){width=500px}
Energia- ja transpordikaupade kogukulutuste elastsused on jÃ¤rgmised.

![FIDELIO mudelis kasutatud energia- ja transpordikaupade sissetulekuelastused](fidelioenergiasissetulekuelastsused.png){width=500px}

Allikas: @kratena_fidelio_2017, lk 34


AlljÃ¤rgnevalt on toodud veel tulemused ka Poola ja TÃ¼rgi kohta, mis oma arengutasemelt vÃµiksid olla sarnased Eestile. Poola kohta hindas kasutades QUAIDS mudelit [@gostkowski_elasticity_2018].

**Tabel. Poola tarbimise elastsused QUAIDS mudelist**

Goods| Price elasticities| Expenditure elasticities |
|:-------------|:--------------|:-------------|
|Home and equipment including   expenditure for housing, water, electricity, gas and furnishings, household   equipment | â€“0.824 | 0.878 | 
Communication and education | â€“1.266 |  0.669 |
|Miscellaneous goods and   services including expenditure for alcoholic beverages, tobacco, expenditure   for clothing and footwear and miscellaneous goods and services | 0.755 | 1.292 |
|Transport and recreation | â€“1.315  | 1.697 | 
|Food and health | â€“0.359 | 0.717 |
|Restaurants and hotels | â€“2.650 | 1.517 |


Allikas: @gostkowski_elasticity_2018, tabelid 4 ja 5


TÃ¼rgi kohta hindas elastsused kasutades LES (linear expenditure system) mudelit @ozer_demand_2003.

**Tabel. TÃ¼rgi tarbimise elastsused LES mudelist**

Goods| Price elasticities| Expenditure elasticities |
|:-------------|:--------------|:-------------|
|Food |	-0.884 |	0.935
|Clothing |	-1.113 |	1.356
|Furniture |	-1.211 |	0.978
|Health	|-1.165	| 1
|Housing	|-0.982	| 0.991
|Transport and communication | -1.191	| 0.795
|Culture, Education, Recreation	| -1.28	| 1.027
|Miscellaneous  | -1.373	| 1.141


Allikas: @ozer_demand_2003, tabelid 4 ja 5

Ãœlaltoodud riikide nÃ¤idetest on nÃ¤ha, et hinnatud ja kasutatud elastsuste variatsioon on vÃ¤ga suur. Et Eesti kohta leitud hinnaelastsuste hinnangute usalduspiirid olid vÃ¤ga laiad, siis vÃµtame lisainformatsioonina kÃµrvale FIDELIO mudelis kasutatud elastsusi ning Poola tulemusi ja pakume nende pÃµhjal vÃ¤lja sisendi projekti makromudelisse.

Projekti sisendvÃ¤ljundtabelis toodud majandusharud ei vasta leibkondade tarbimisstruktuurile, mistÃµttu peab leidma vÃµimalike lÃ¤hendi. AlljÃ¤rgnevas tabelis on toodud vÃµimalik ettepanek, milliseid elastsuseid kasutada.


```{r}

library(readxl)
dfcoicopio <- read_xlsx(path  = "../Muu/Tegevusala tootegrupp coicop.xlsx", sheet ="andmed")
#dfcoicopio <- read_xlsx(path  = "./Muu/Tegevusala tootegrupp coicop.xlsx", sheet ="andmed") 

dfcoicopio <- dfcoicopio %>% 
  select(Rida, Tegevusala, `EMTAK 2008`, `Kodumajapidamiste osakaal kogutoodangus`, COICOPtase1, COICOPtase1nimetus, Sissetulekuelastsus,	Hinnaelastsus)

colnames(dfcoicopio)<- c("Rida", "Tegevusala IO tabelis", "EMTAK", "Kodumajapidamiste osakaal kogutoodangus","COICOP", "Nimetus", "Sissetulekuelastsus", "Hinnaelastsus")


dfcoicopio$`Kodumajapidamiste osakaal kogutoodangus` <- round(dfcoicopio$`Kodumajapidamiste osakaal kogutoodangus`, 3)

#dfcoicopio <- read_xlsx(path  = "C:/Users/avork/Documents/demandsystemEE/Andmed/Tegevusala tootegrupp #coicop.xlsx", sheet ="andmed")
#colnames(dfcoicopio)

#dfcoicopio <- read_xlsx(file = "../Andmed/Tegevusala tootegrupp coicop.xlsx", sheet ="Andmed")
library(knitr)
kable(dfcoicopio)

elastsustesisendandmed <- dfcoicopio %>% select(Rida, `Tegevusala IO tabelis`, Sissetulekuelastsus, Hinnaelastsus) %>%  rename(`Tegevusala lÃ¼hend` = `Tegevusala IO tabelis`)

save(elastsustesisendandmed, file = "../Andmed/elastsustesisendandmed.RData")

```


## KokkuvÃµte

KÃ¤esolevas raportis pÃ¼Ã¼ti hinnata leibkonna-eelarve uuringu agregeeritud kulutuste struktuuri pÃµhjal tarbimise elastsused kogukulutuste ja hindade suhtes kasutades AIDS ja LA-AIDS nÃµudlussÃ¼steemi. AnalÃ¼Ã¼siga leitud kogukulutuste elastsused olid hinnatud vÃµrdlemisi tÃ¤pselt, kuid hinnaelastsuste usalduspiirid olid vÃ¤ga laiad. Kombineerides kÃ¤esolevas analÃ¼Ã¼sis leitud elastuste vÃ¤Ã¤rtused ja varasemates uuringutes kasutusel olevad hinnangud, pakutakse vÃ¤lja sisendid projektis "COVID-19 seotud majandusmÃµjude ning nende pehmendamiseks mÃµeldud poliitikameetmete tÃµhususe hindamine" kasutusel oleva sisend-vÃ¤ljund mudeli jaoks.


## Kasutatud materjalid

<div id="refs"></div> 




<!-- ## Lisa. Working-Leseri tarbimisfunktsioonist elastsuste valemite tuletamine -->

<!-- Tarbimisfunktsioon:  -->

<!-- $$w_i= \alpha_0 + \alpha_i log(y) + \sum_{j=1}^k \beta_{ij}log(p_j) + \lambda H_i + u_i$$ -->

<!-- kus $w_i= q_i p_i / y$ -->

<!-- Sissetulekuelastsuse valemi tuletamine: -->

<!-- $$ -->
<!-- \begin{aligned} -->

<!-- e_i & = \frac{d \log(q_i)} {d \log(y)}  \\  -->
<!-- & = \frac{d \log(y w_i /p_i)}{d\log(y)}  , \text{  sest  }  w_i = p_i q_i/y  \text{   ja  }  q_i = y w_i /p_i \\ -->
<!-- & = \frac{d \log(y)}{d\log(y)} + \frac{d \log(w_i)}{d\log(y)} - \frac{d \log(p_i)}{d\log(y)}  \\ -->
<!-- & = 1 + \frac{dw_i/w_i}{dlog(y)} - 0 \\ -->
<!-- & = 1 + \alpha_i/w_i  -->

<!-- \end{aligned} -->

<!-- $$ -->

<!-- Oma hinnaelastsuse valemi tuletamiseks saab kasutada ilmutamata funktsioonist tuletise vÃµtmise Ã¼ldist reeglit: kui $F(x,y) =0$, siis $dx/dy = -F'_y/F'_x$ ehk tuletis avaldub kui osatuletiste negatiivne suhe. -->

<!-- $$ -->
<!-- \text{Ilmutamata kujul valem}:  -->
<!-- w_i - \alpha_0 - \alpha_i log(y) - \sum_{j=1}^k \beta_{ij}log(p_j) = 0 \\  -->

<!-- \text{Osatuletis}:  -->
<!-- dq/dp=-Fâ€™_p/Fâ€™_q \\ -->

<!-- F'_p = q/y - \beta_{ii}/p_i \\ -->
<!-- F'_q = p_i/y \\ -->

<!-- dq/dp = - \frac{q/y - \beta_{ii}/p_i}{p/y} = - \frac{q - \beta_{ii}y/p_i}{p_i} =      \\ -->

<!-- \text{elastsus}:  -->
<!-- e_{ii} = dq_i/dp_i \times p_i/q_i  = - \frac{q_i - \beta_{ii}y/p_i}{p_i} \times p_i/q_i = - 1 + \beta_{ii} y/(p_i q_i) \\    -->

<!-- e_{ii} =âˆ’1+\beta_{ii}/w_i -->
<!-- $$ -->


<!-- JÃ¤Ã¤gid -->

<!-- ![Tabel 2. Duaalsusseosed majapidamisteoorias](duaalsusedmajapidamisteoorias.jpg){width=500px} -->
